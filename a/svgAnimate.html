<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVG绘制过程动画</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        line-height: 1.6;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        color: #333;
        background-color: #f5f5f5;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
        color: #2c3e50;
      }

      .container {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .controls {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .svg-container {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        min-height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      svg {
        max-width: 100%;
        max-height: 400px;
        border: 1px dashed #ccc;
      }

      button {
        padding: 8px 16px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        margin-right: 10px;
      }

      button:hover {
        background-color: #2980b9;
      }

      input,
      select {
        padding: 8px;
        margin-right: 10px;
        border-radius: 4px;
        border: 1px solid #ccc;
      }

      .control-group {
        margin-bottom: 15px;
      }

      label {
        margin-right: 10px;
        font-weight: bold;
      }

      /* 移除默认样式，让元素保留原始样式 */
      .preserve-style path,
      .preserve-style line,
      .preserve-style polyline,
      .preserve-style polygon,
      .preserve-style rect,
      .preserve-style circle,
      .preserve-style ellipse {
        /* 保留原有样式，不强制设置fill和stroke */
      }

      /* 线条模式 */
      .outline-mode path,
      .outline-mode line,
      .outline-mode polyline,
      .outline-mode polygon,
      .outline-mode rect,
      .outline-mode circle,
      .outline-mode ellipse {
        fill: none;
        stroke: #333;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
    </style>
  </head>
  <body>
    <h1>SVG绘制过程动画</h1>

    <div class="container">
      <div class="controls">
        <div class="control-group">
          <label>选择示例SVG:</label>
          <select id="svg-example">
            <option value="">--选择示例--</option>
            <option value="heart">心形</option>
            <option value="star">星形</option>
            <option value="house">房子</option>
            <option value="face">笑脸</option>
            <option value="sun">太阳</option>
          </select>
          <button id="load-example">加载示例</button>
        </div>

        <div class="control-group">
          <label>或上传SVG文件:</label>
          <input type="file" id="svg-file" accept=".svg" />
        </div>

        <div class="control-group">
          <label>渲染模式:</label>
          <select id="render-mode">
            <option value="outline">线条模式</option>
            <option value="fill">填充模式</option>
            <option value="mixed">混合模式</option>
          </select>
        </div>

        <div class="control-group">
          <label>动画持续时间(秒):</label>
          <input
            type="number"
            id="duration"
            value="3"
            min="0.5"
            max="10"
            step="0.5"
          />

          <label>动画延迟(秒):</label>
          <input
            type="number"
            id="delay"
            value="0"
            min="0"
            max="5"
            step="0.1"
          />
        </div>

        <div class="control-group">
          <button id="animate-btn">开始动画</button>
          <button id="reset-btn">重置</button>
        </div>
      </div>

      <div class="svg-container">
        <div id="svg-display"></div>
      </div>
    </div>

    <script>
      // SVG示例库
      const svgExamples = {
        heart: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                      <path d="M50,30 C27,10 0,26 0,50 C0,75 25,80 50,100 C75,80 100,75 100,50 C100,26 73,10 50,30 Z" />
                   </svg>`,
        star: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <path d="M50,10 L61,35 L87,35 L65,50 L74,77 L50,60 L26,77 L35,50 L13,35 L39,35 Z" />
                  </svg>`,
        house: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                      <path d="M20,80 L20,40 L50,20 L80,40 L80,80 Z" />
                      <path d="M40,80 L40,50 L60,50 L60,80 Z" />
                      <rect x="35" y="30" width="10" height="10" />
                      <rect x="55" y="30" width="10" height="10" />
                   </svg>`,
        face: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                     <circle cx="50" cy="50" r="40" />
                     <circle cx="35" cy="40" r="5" />
                     <circle cx="65" cy="40" r="5" />
                     <path d="M35,70 Q50,80 65,70" />
                   </svg>`,
        sun: `<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 103.04 98.15" width="103.04" height="98.15">
                    <g transform="translate(46.98 30.24) rotate(0 4.36 17.97)" stroke="none">
                        <path fill="#ffd43b" d="M0.73,2.52 Q0.73,2.52 -1.66,3.22 -4.06,3.92 -6.86,5.96 -9.66,8.01 -11.49,10.39 -13.31,12.77 -14.06,15.05 -14.80,17.32 -14.95,19.87 -15.10,22.41 -13.23,25.32 -11.37,28.23 -8.98,29.82 -6.60,31.40 -3.75,32.13 -0.91,32.86 2.31,33.04 5.55,33.22 8.40,32.76 11.24,32.29 13.81,30.87 16.37,29.44 18.35,27.61 20.32,25.77 21.46,23.83 22.61,21.90 23.18,19.35 23.75,16.79 22.77,14.36 21.79,11.93 19.79,10.89 17.79,9.85 15.49,9.58 13.18,9.30 10.44,9.37 7.69,9.44 5.42,10.29 3.16,11.14 1.66,13.34 0.16,15.54 0.29,18.15 0.43,20.76 2.60,21.92 4.77,23.07 7.12,22.83 9.47,22.58 10.87,20.96 12.27,19.34 11.42,19.21 10.58,19.07 10.17,18.97 9.75,18.86 9.40,18.63 9.04,18.40 8.78,18.07 8.51,17.74 8.37,17.34 8.22,16.94 8.21,16.51 8.20,16.09 8.33,15.68 8.46,15.28 8.70,14.93 8.95,14.59 9.30,14.34 9.65,14.09 10.05,13.97 10.46,13.85 10.88,13.86 11.31,13.88 11.71,14.02 12.11,14.17 12.44,14.44 12.77,14.71 12.99,15.07 13.22,15.43 13.32,15.84 13.42,16.25 13.39,16.67 13.35,17.10 13.18,17.49 13.01,17.88 12.72,18.19 12.44,18.51 12.07,18.71 11.70,18.92 11.28,19.00 10.86,19.08 10.44,19.02 10.02,18.96 9.64,18.77 9.26,18.58 8.96,18.28 8.66,17.98 8.48,17.59 8.29,17.21 8.23,16.79 8.18,16.37 8.26,15.95 8.34,15.54 8.55,15.17 8.76,14.80 9.08,14.52 9.40,14.23 9.79,14.07 10.18,13.90 10.60,13.87 11.03,13.84 11.03,13.84 11.03,13.84 14.24,16.96 17.46,20.09 16.52,22.25 15.59,24.41 13.21,26.03 10.83,27.65 7.57,27.98 4.30,28.31 1.98,27.83 -0.34,27.35 -2.47,24.80 -4.60,22.26 -4.95,20.09 -5.30,17.92 -4.96,15.66 -4.61,13.39 -3.63,11.49 -2.64,9.59 -0.90,8.01 0.84,6.42 2.87,5.60 4.91,4.77 7.20,4.39 9.50,4.01 12.49,4.07 15.49,4.14 18.45,4.84 21.41,5.54 23.50,6.93 25.60,8.32 27.07,10.17 28.55,12.03 28.76,14.70 28.97,17.37 28.56,19.62 28.15,21.86 27.05,24.42 25.95,26.97 23.84,29.32 21.73,31.67 18.87,33.76 16.00,35.84 12.44,37.08 8.87,38.31 5.32,38.33 1.78,38.34 -1.93,37.79 -5.65,37.24 -8.97,35.65 -12.29,34.06 -14.98,31.44 -17.67,28.82 -19.00,25.57 -20.33,22.31 -20.15,19.30 -19.96,16.29 -18.85,13.11 -17.74,9.94 -15.46,7.02 -13.17,4.10 -11.46,2.61 -9.74,1.11 -7.65,-0.00 -5.56,-1.11 -3.14,-1.81 -0.73,-2.52 -0.42,-2.57 -0.11,-2.62 0.20,-2.59 0.52,-2.57 0.82,-2.47 1.12,-2.37 1.38,-2.20 1.65,-2.03 1.87,-1.80 2.09,-1.58 2.25,-1.30 2.41,-1.03 2.50,-0.72 2.59,-0.42 2.60,-0.10 2.61,0.20 2.55,0.51 2.49,0.82 2.35,1.11 2.22,1.39 2.02,1.64 1.82,1.89 1.57,2.08 1.31,2.27 1.02,2.39 0.73,2.52 0.73,2.52 Z"/>
                    </g>
                    <g transform="translate(42.45 10) rotate(0 1.74 3.66)" stroke="none">
                        <path fill="#f08c00" d="M2.42,-1.00 Q2.42,-1.00 3.67,1.71 4.92,4.42 5.05,4.83 5.19,5.23 5.19,5.65 5.19,6.08 5.06,6.48 4.92,6.88 4.66,7.22 4.41,7.56 4.06,7.80 3.70,8.04 3.30,8.15 2.89,8.27 2.46,8.25 2.04,8.22 1.64,8.07 1.25,7.91 0.92,7.64 0.60,7.36 0.38,7.00 0.16,6.63 0.07,6.22 -0.01,5.80 0.02,5.38 0.07,4.96 0.24,4.57 0.42,4.19 0.71,3.88 1.01,3.57 1.38,3.37 1.76,3.17 2.17,3.10 2.59,3.03 3.01,3.10 3.43,3.17 3.81,3.37 4.18,3.56 4.48,3.87 4.77,4.18 4.95,4.57 5.13,4.95 5.17,5.37 5.22,5.80 5.13,6.21 5.04,6.63 4.82,6.99 4.60,7.36 4.28,7.63 3.96,7.91 3.56,8.06 3.17,8.22 2.74,8.25 2.32,8.27 1.91,8.16 1.50,8.04 1.15,7.80 0.79,7.57 0.54,7.23 0.28,6.89 0.28,6.89 0.28,6.89 -1.07,3.94 -2.42,1.00 -2.51,0.69 -2.59,0.38 -2.60,0.07 -2.61,-0.24 -2.54,-0.55 -2.48,-0.86 -2.34,-1.14 -2.20,-1.43 -1.99,-1.67 -1.79,-1.91 -1.54,-2.10 -1.28,-2.29 -0.99,-2.41 -0.69,-2.53 -0.38,-2.57 -0.07,-2.62 0.24,-2.59 0.55,-2.56 0.85,-2.46 1.15,-2.35 1.42,-2.18 1.68,-2.01 1.90,-1.78 2.11,-1.55 2.27,-1.27 2.42,-0.99 2.42,-0.99 Z"/>
                    </g>
                    <g transform="translate(10 33.73) rotate(0 4.71 1.74)" stroke="none">
                        <path fill="#f08c00" d="M0.91,-2.46 Q0.91,-2.46 3.62,-1.46 6.32,-0.45 6.69,-0.24 7.06,-0.03 7.35,0.28 7.63,0.59 7.80,0.98 7.96,1.37 8.00,1.80 8.03,2.22 7.93,2.63 7.82,3.05 7.59,3.40 7.36,3.76 7.03,4.03 6.70,4.29 6.30,4.44 5.90,4.58 5.47,4.59 5.05,4.60 4.64,4.48 4.24,4.35 3.89,4.10 3.55,3.85 3.30,3.51 3.06,3.16 2.93,2.76 2.81,2.35 2.82,1.92 2.83,1.50 2.98,1.10 3.13,0.70 3.40,0.37 3.66,0.04 4.02,-0.18 4.38,-0.40 4.79,-0.51 5.21,-0.61 5.63,-0.57 6.05,-0.54 6.44,-0.37 6.83,-0.20 7.15,0.08 7.46,0.36 7.67,0.73 7.88,1.10 7.96,1.52 8.04,1.94 7.98,2.36 7.92,2.78 7.73,3.16 7.54,3.54 7.24,3.84 6.94,4.14 6.56,4.33 6.18,4.51 5.75,4.57 5.33,4.63 4.92,4.55 4.50,4.46 4.50,4.46 4.50,4.46 1.79,3.46 -0.91,2.46 -1.19,2.31 -1.47,2.17 -1.71,1.96 -1.95,1.75 -2.13,1.49 -2.31,1.23 -2.43,0.94 -2.54,0.64 -2.58,0.33 -2.62,0.02 -2.59,-0.29 -2.55,-0.60 -2.44,-0.90 -2.33,-1.20 -2.15,-1.46 -1.97,-1.72 -1.74,-1.93 -1.50,-2.15 -1.22,-2.29 -0.95,-2.44 -0.64,-2.52 -0.33,-2.60 -0.02,-2.60 0.29,-2.60 0.60,-2.53 0.91,-2.46 0.91,-2.46 Z"/>
                    </g>
                    <g transform="translate(82.22 29.54) rotate(0 4.01 -1.92)" stroke="none">
                        <path fill="#f08c00" d="M-1.17,-2.34 Q-1.17,-2.34 1.93,-3.85 5.05,-5.36 5.46,-5.47 5.86,-5.58 6.29,-5.56 6.71,-5.53 7.11,-5.38 7.50,-5.22 7.83,-4.94 8.15,-4.67 8.37,-4.30 8.59,-3.94 8.68,-3.52 8.77,-3.11 8.72,-2.68 8.67,-2.26 8.49,-1.88 8.32,-1.49 8.02,-1.18 7.73,-0.88 7.35,-0.68 6.98,-0.48 6.56,-0.41 6.14,-0.34 5.72,-0.41 5.30,-0.48 4.93,-0.68 4.55,-0.88 4.26,-1.19 3.97,-1.50 3.79,-1.89 3.61,-2.27 3.57,-2.69 3.52,-3.12 3.61,-3.53 3.71,-3.95 3.93,-4.31 4.15,-4.67 4.47,-4.95 4.79,-5.22 5.19,-5.38 5.58,-5.54 6.01,-5.56 6.43,-5.58 6.84,-5.47 7.25,-5.35 7.60,-5.11 7.95,-4.87 8.21,-4.53 8.47,-4.19 8.60,-3.79 8.74,-3.39 8.74,-2.96 8.74,-2.54 8.60,-2.14 8.46,-1.73 8.20,-1.40 7.95,-1.06 7.59,-0.82 7.24,-0.58 7.24,-0.58 7.24,-0.58 4.21,0.88 1.17,2.34 0.87,2.45 0.57,2.56 0.26,2.59 -0.05,2.62 -0.36,2.58 -0.67,2.53 -0.97,2.41 -1.26,2.30 -1.52,2.11 -1.78,1.93 -1.98,1.69 -2.19,1.44 -2.33,1.16 -2.47,0.88 -2.54,0.57 -2.61,0.26 -2.60,-0.05 -2.60,-0.36 -2.51,-0.67 -2.43,-0.97 -2.28,-1.25 -2.13,-1.53 -1.91,-1.76 -1.70,-2.00 -1.43,-2.17 -1.17,-2.34 -1.17,-2.34 Z"/>
                    </g>
                    <g transform="translate(13.49 75.94) rotate(0 4.88 -2.79)" stroke="none">
                        <path fill="#f08c00" d="M-1.31,-2.27 Q-1.31,-2.27 0.58,-3.37 2.49,-4.47 4.21,-5.45 5.94,-6.43 6.34,-6.58 6.73,-6.72 7.16,-6.73 7.58,-6.75 7.99,-6.62 8.40,-6.50 8.74,-6.25 9.09,-6.00 9.34,-5.66 9.58,-5.31 9.71,-4.91 9.83,-4.50 9.82,-4.07 9.81,-3.65 9.67,-3.25 9.52,-2.85 9.25,-2.52 8.99,-2.19 8.63,-1.96 8.27,-1.73 7.86,-1.63 7.45,-1.52 7.02,-1.56 6.60,-1.59 6.21,-1.76 5.82,-1.93 5.50,-2.21 5.19,-2.50 4.98,-2.87 4.77,-3.24 4.69,-3.65 4.61,-4.07 4.66,-4.49 4.72,-4.91 4.91,-5.29 5.10,-5.67 5.40,-5.97 5.70,-6.27 6.08,-6.46 6.46,-6.65 6.88,-6.71 7.30,-6.77 7.72,-6.69 8.14,-6.61 8.51,-6.40 8.88,-6.19 9.16,-5.88 9.44,-5.56 9.61,-5.17 9.78,-4.78 9.82,-4.35 9.85,-3.93 9.75,-3.52 9.65,-3.11 9.42,-2.75 9.19,-2.39 8.86,-2.12 8.53,-1.86 8.53,-1.86 8.53,-1.86 6.83,-0.89 5.12,0.06 3.22,1.16 1.31,2.27 1.02,2.39 0.73,2.52 0.42,2.57 0.10,2.62 -0.20,2.59 -0.52,2.57 -0.82,2.47 -1.12,2.37 -1.39,2.20 -1.65,2.03 -1.87,1.80 -2.09,1.58 -2.25,1.30 -2.41,1.03 -2.50,0.72 -2.59,0.42 -2.60,0.10 -2.61,-0.20 -2.55,-0.51 -2.49,-0.82 -2.35,-1.11 -2.22,-1.40 -2.02,-1.64 -1.82,-1.89 -1.56,-2.08 -1.31,-2.27 -1.31,-2.27 Z"/>
                    </g>
                    <g transform="translate(53.61 78.38) rotate(0 0.87 4.88)" stroke="none">
                        <path fill="#f08c00" d="M2.60,-0.33 Q2.60,-0.33 2.90,1.96 3.20,4.27 3.51,5.64 3.82,7.00 3.84,7.43 3.87,7.85 3.75,8.26 3.64,8.67 3.40,9.02 3.16,9.38 2.83,9.63 2.49,9.89 2.09,10.03 1.68,10.16 1.26,10.17 0.83,10.17 0.43,10.03 0.03,9.90 -0.30,9.64 -0.64,9.38 -0.88,9.03 -1.12,8.68 -1.23,8.27 -1.35,7.86 -1.32,7.44 -1.30,7.01 -1.15,6.62 -0.99,6.22 -0.71,5.90 -0.44,5.57 -0.08,5.35 0.28,5.13 0.69,5.04 1.11,4.95 1.53,5.00 1.95,5.04 2.34,5.22 2.73,5.40 3.03,5.69 3.34,5.98 3.54,6.36 3.74,6.73 3.81,7.15 3.88,7.57 3.81,7.99 3.74,8.41 3.55,8.78 3.35,9.16 3.04,9.45 2.73,9.75 2.35,9.92 1.96,10.10 1.54,10.15 1.11,10.20 0.70,10.11 0.28,10.01 -0.07,9.80 -0.43,9.58 -0.71,9.25 -0.99,8.93 -1.14,8.54 -1.30,8.14 -1.30,8.14 -1.30,8.14 -1.65,6.55 -2.00,4.95 -2.30,2.64 -2.60,0.33 -2.60,0.02 -2.61,-0.29 -2.53,-0.60 -2.46,-0.90 -2.31,-1.19 -2.17,-1.47 -1.96,-1.71 -1.75,-1.95 -1.50,-2.13 -1.24,-2.31 -0.94,-2.42 -0.65,-2.54 -0.33,-2.58 -0.02,-2.62 0.29,-2.59 0.60,-2.55 0.90,-2.44 1.20,-2.33 1.46,-2.15 1.72,-1.98 1.93,-1.74 2.14,-1.51 2.29,-1.23 2.44,-0.95 2.52,-0.64 2.60,-0.33 2.60,-0.33 Z"/>
                    </g>
                    <g transform="translate(85.01 57.80) rotate(0 4.01 1.57)" stroke="none">
                        <path fill="#f08c00" d="M0.79,-2.50 Q0.79,-2.50 4.21,-1.23 7.62,0.03 7.97,0.27 8.32,0.52 8.57,0.86 8.82,1.20 8.95,1.61 9.08,2.01 9.08,2.44 9.07,2.86 8.93,3.26 8.79,3.66 8.53,4.00 8.26,4.33 7.91,4.56 7.55,4.80 7.14,4.90 6.73,5.01 6.31,4.98 5.88,4.95 5.49,4.79 5.10,4.63 4.78,4.35 4.46,4.07 4.24,3.70 4.03,3.33 3.95,2.92 3.86,2.50 3.91,2.08 3.96,1.66 4.15,1.27 4.33,0.89 4.63,0.59 4.93,0.28 5.31,0.09 5.68,-0.09 6.10,-0.16 6.52,-0.22 6.94,-0.14 7.36,-0.07 7.73,0.13 8.11,0.33 8.39,0.64 8.68,0.96 8.85,1.34 9.03,1.73 9.07,2.16 9.11,2.58 9.01,2.99 8.91,3.41 8.69,3.77 8.46,4.13 8.13,4.40 7.81,4.67 7.41,4.82 7.01,4.97 6.59,4.99 6.16,5.00 5.75,4.88 5.35,4.76 5.35,4.76 5.35,4.76 2.27,3.63 -0.79,2.50 -1.08,2.37 -1.37,2.23 -1.62,2.04 -1.86,1.84 -2.06,1.59 -2.25,1.34 -2.38,1.05 -2.51,0.76 -2.56,0.45 -2.62,0.14 -2.60,-0.17 -2.58,-0.48 -2.48,-0.79 -2.38,-1.09 -2.22,-1.36 -2.05,-1.63 -1.83,-1.85 -1.60,-2.07 -1.33,-2.23 -1.06,-2.40 -0.76,-2.49 -0.45,-2.58 -0.14,-2.60 0.17,-2.62 0.48,-2.56 0.79,-2.50 0.79,-2.50 Z"/>
                    </g>
                </svg>`,
      };

      // 获取DOM元素
      const svgDisplay = document.getElementById("svg-display");
      const svgExampleSelect = document.getElementById("svg-example");
      const loadExampleBtn = document.getElementById("load-example");
      const svgFileInput = document.getElementById("svg-file");
      const durationInput = document.getElementById("duration");
      const delayInput = document.getElementById("delay");
      const animateBtn = document.getElementById("animate-btn");
      const resetBtn = document.getElementById("reset-btn");
      const renderModeSelect = document.getElementById("render-mode");

      // 加载示例SVG
      loadExampleBtn.addEventListener("click", () => {
        const selected = svgExampleSelect.value;
        if (selected && svgExamples[selected]) {
          svgDisplay.innerHTML = svgExamples[selected];
          prepareSVGForAnimation();
        }
      });

      // 上传SVG文件
      svgFileInput.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (file && file.type === "image/svg+xml") {
          const reader = new FileReader();
          reader.onload = (event) => {
            svgDisplay.innerHTML = event.target.result;
            prepareSVGForAnimation();
          };
          reader.readAsText(file);
        }
      });

      // 渲染模式变化
      renderModeSelect.addEventListener("change", () => {
        applyRenderMode();
      });

      // 应用渲染模式
      function applyRenderMode() {
        const svg = svgDisplay.querySelector("svg");
        if (!svg) return;

        // 清除所有可能的类
        svg.classList.remove("outline-mode", "preserve-style");

        // 应用选定的模式
        const mode = renderModeSelect.value;
        switch (mode) {
          case "outline":
            svg.classList.add("outline-mode");
            break;
          case "fill":
            svg.classList.add("preserve-style");
            break;
          case "mixed":
            // 在混合模式中，我们保留原始样式并添加动画
            svg.classList.add("preserve-style");
            break;
        }

        // 重置动画状态
        resetAnimation();
      }

      // 准备SVG动画
      function prepareSVGForAnimation() {
        const svg = svgDisplay.querySelector("svg");
        if (!svg) return;

        // 确保SVG有正确的宽高
        if (!svg.getAttribute("width")) {
          svg.setAttribute("width", "100%");
        }
        if (!svg.getAttribute("height")) {
          svg.setAttribute("height", "100%");
        }

        // 应用当前选择的渲染模式
        applyRenderMode();

        // 处理所有可动画的SVG元素
        const elements = svg.querySelectorAll(
          "path, line, polyline, polygon, rect, circle, ellipse"
        );

        elements.forEach((el) => {
          // 备份原始样式（如果有）
          if (el.getAttribute("fill")) {
            el.dataset.originalFill = el.getAttribute("fill");
          }
          if (el.getAttribute("stroke")) {
            el.dataset.originalStroke = el.getAttribute("stroke");
          }
          if (el.getAttribute("stroke-width")) {
            el.dataset.originalStrokeWidth = el.getAttribute("stroke-width");
          }

          // 获取路径长度
          let length;
          if (
            el.tagName.toLowerCase() === "rect" ||
            el.tagName.toLowerCase() === "circle" ||
            el.tagName.toLowerCase() === "ellipse"
          ) {
            // 对于基本图形，我们需要计算周长
            const bbox = el.getBBox();
            length = 2 * (bbox.width + bbox.height);
          } else {
            length = el.getTotalLength ? el.getTotalLength() : 1000;
          }

          // 设置初始状态 - 完全不可见
          el.style.strokeDasharray = length;
          el.style.strokeDashoffset = length;

          // 在填充模式下，修改实现方式
          if (renderModeSelect.value === "fill") {
            const originalFill = el.dataset.originalFill;
            if (originalFill) {
              el.setAttribute("fill", originalFill);
              // 初始时填充透明
              el.style.fillOpacity = "0";
              // 添加一个与填充色相同的描边，用于绘制动画
              const fillColor = originalFill === "none" ? "#333" : originalFill;
              el.setAttribute("stroke", fillColor);
              el.setAttribute("stroke-width", "2");
            }
          } else if (renderModeSelect.value === "mixed") {
            // 混合模式：保留填充，添加描边
            const originalFill = el.dataset.originalFill;
            if (originalFill) {
              el.setAttribute("fill", originalFill);
              el.style.clipPath = "inset(0 100% 0 0)";
            }

            // 添加描边（如果没有）
            if (
              !el.getAttribute("stroke") ||
              el.getAttribute("stroke") === "none"
            ) {
              el.setAttribute("stroke", "#333");
              el.setAttribute("stroke-width", "2");
            }
          }

          // 存储原始属性值
          el.dataset.length = length;
        });
      }

      // 开始动画
      // 开始动画 - 修改部分
      animateBtn.addEventListener("click", () => {
        const duration = parseFloat(durationInput.value) || 3;
        const delay = parseFloat(delayInput.value) || 0;

        const elements = svgDisplay.querySelectorAll(
          "path, line, polyline, polygon, rect, circle, ellipse"
        );

        elements.forEach((el, index) => {
          const length = parseFloat(el.dataset.length) || 1000;

          // 重置动画状态
          el.style.strokeDashoffset = length;
          if (renderModeSelect.value === "fill") {
            el.style.fillOpacity = "0";
          } else if (el.style.clipPath) {
            el.style.clipPath = "inset(0 100% 0 0)";
          }

          // 设置动画
          el.style.transition = "none";
          setTimeout(() => {
            // 线条绘制动画
            el.style.transition = `stroke-dashoffset ${
              duration * 0.6
            }s ease-in-out ${delay + index * 0.1}s`;
            el.style.strokeDashoffset = "0";

            // 如果是填充模式，添加填充淡入效果
            if (renderModeSelect.value === "fill") {
              if (
                el.dataset.originalFill &&
                el.dataset.originalFill !== "none"
              ) {
                // 线条绘制完成后，开始填充显现的动画
                el.style.transition += `, fill-opacity ${
                  duration * 0.4
                }s ease-in-out ${delay + duration * 0.6 + index * 0.1}s`;
                el.style.fillOpacity = "1";
              }
            } else if (renderModeSelect.value === "mixed") {
              // ...混合模式代码保持不变...
              if (
                el.dataset.originalFill &&
                el.dataset.originalFill !== "none"
              ) {
                el.style.transition += `, clip-path ${duration}s ease-in-out ${
                  delay + index * 0.1
                }s`;
                el.style.clipPath = "inset(0 0 0 0)";
              }
            }
          }, 10);
        });
      });

      // 重置按钮
      resetBtn.addEventListener("click", () => {
        resetAnimation();
      });

      // 重置动画状态
      // 重置动画状态 - 修改部分
      function resetAnimation() {
        const elements = svgDisplay.querySelectorAll(
          "path, line, polyline, polygon, rect, circle, ellipse"
        );

        elements.forEach((el) => {
          const length = parseFloat(el.dataset.length) || 1000;
          el.style.transition = "none";
          el.style.strokeDashoffset = length;

          // 根据不同模式重置状态
          if (renderModeSelect.value === "fill") {
            if (el.dataset.originalFill && el.dataset.originalFill !== "none") {
              el.style.fillOpacity = "0";
            }
          } else if (renderModeSelect.value === "mixed") {
            if (el.dataset.originalFill && el.dataset.originalFill !== "none") {
              el.style.clipPath = "inset(0 100% 0 0)";
            }
          }
        });
      }

      // 加载默认示例
      window.addEventListener("DOMContentLoaded", () => {
        svgExampleSelect.value = "sun"; // 默认加载太阳示例
        loadExampleBtn.click();
      });
    </script>
  </body>
</html>
